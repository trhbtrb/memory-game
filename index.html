<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Added viewport meta tag for responsiveness -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Memorization Game</title>
    <!-- Import Roboto Mono from Google Fonts for enhanced clarity -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono&display=swap" rel="stylesheet">
    <style>
        /* CSS Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #e9f5ff;
            margin: 0;
            padding: 0;
        }

        #submit-btn {
            font-size: 1.125rem;
            padding: 0.625rem 1.25rem;
            margin: 0.3125rem auto; /* Centers the button horizontally */
            border: none;
            background-color: #1e90ff;
            color: #fff;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            display: none; /* Hide submit button initially */
            max-width: 200px; /* Optional: Control the button's maximum width */
        }

        #submit-btn:hover {
            background-color: #00bfff;
        }

        .game-container {
            text-align: center;
            padding: 50px;
        }

        #game-area {
            margin: 0 auto;
            width: 50%;
            background-color: #ffffff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        #main-title {
            color: #333;
            font-size: 2rem;
            margin-bottom: 20px;
        }

        #message {
            font-size: 1.5rem;
            color: #333;
            margin-bottom: 20px;
        }

        #timer-display {
            font-size: 1.25rem;
            color: #dc143c;
            margin-bottom: 20px;
        }

        /* Applied Roboto Mono to #numbers and #player-input */
        #numbers, #player-input {
            font-family: 'Roboto Mono', 'Consolas', 'Courier New', monospace;
        }

        #numbers {
            font-size: 2rem;
            color: #1e90ff;
            margin-bottom: 20px;
        }

        #player-input {
            font-size: 1.5rem;
            padding: 0.625rem; /* 10px */
            width: 80%;
            box-sizing: border-box;
            border: 2px solid #1e90ff;
            border-radius: 5px;
            display: none; /* Hide input field initially */
            margin: 0 auto; /* Center the input field */
        }

        #player-input:focus {
            outline: none;
            border-color: #00bfff;
        }

        #difficulty-description {
            font-size: 1rem;
            color: #555;
            margin-top: 20px;
            margin-bottom: 20px;
            line-height: 1.5;
            text-align: center;
        }

        #buttons {
            margin-bottom: 20px;
        }

        /* Mode Selection Buttons */
        .mode-button {
            font-size: 1.125rem; /* 18px */
            padding: 0.625rem 1.25rem; /* 10px 20px */
            margin: 0.3125rem; /* 5px */
            border: 2px solid #1e90ff;
            background-color: #ffffff;
            color: #1e90ff;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .mode-button.selected {
            background-color: #1e90ff;
            color: #ffffff;
        }

        .mode-button:hover {
            background-color: #00bfff;
            color: #ffffff;
        }

        /* Start Button */
        #start-btn {
            font-size: 1.125rem; /* 18px */
            padding: 0.625rem 1.25rem; /* 10px 20px */
            margin: 0.3125rem; /* 5px */
            border: none;
            background-color: #a9a9a9; /* Disabled color */
            color: #fff;
            border-radius: 5px;
            cursor: not-allowed;
            transition: background-color 0.3s ease;
        }

        #start-btn.enabled {
            background-color: #1e90ff;
            cursor: pointer;
        }

        #start-btn.enabled:hover {
            background-color: #00bfff;
        }

        /* Setup Section */
        #setup {
            display: none; /* Hidden initially */
            margin-bottom: 20px;
            text-align: center;
        }

        #setup label {
            display: block;
            font-size: 1rem;
            color: #333;
            margin-bottom: 5px;
            text-align: center; /* Center the label */
        }

        #setup-inputs {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px; /* Space between inputs */
        }

        .input-group {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #setup-inputs input {
            font-size: 1rem;
            padding: 0.4rem;
            width: 60px;
            border: 2px solid #1e90ff;
            border-radius: 5px;
            text-align: center;
        }

        #setup-inputs input:focus {
            outline: none;
            border-color: #00bfff;
        }

        #confirm-setup-btn {
            font-size: 1.125rem; /* 18px */
            padding: 0.625rem 1.25rem; /* 10px 20px */
            border: none;
            background-color: #1e90ff;
            color: #fff;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin-top: 20px; /* Adds space above the Confirm button */
        }

        #confirm-setup-btn:hover {
            background-color: #00bfff;
        }

        /* Stats */
        #stats {
            font-size: 1.125rem; /* 18px */
            margin-top: 20px;
        }

        #score, #lives {
            margin: 0.3125rem; /* 5px */
        }

        #lives {
            color: #dc143c;
        }

        #results {
            font-size: 1.25rem; /* 20px */
            margin-bottom: 20px;
        }

        #player-answer, #correct-answer {
            margin: 0.625rem 0; /* 10px 0 */
        }

        /* Responsive Styles */
        @media (max-width: 768px) {
            .game-container {
                padding: 30px;
            }

            #game-area {
                width: 80%;
                padding: 20px;
            }

            #main-title {
                font-size: 1.75rem;
            }

            #message {
                font-size: 1.25rem;
            }

            #timer-display {
                font-size: 1.125rem;
            }

            #numbers {
                font-size: 1.75rem;
            }

            #player-input {
                font-size: 1.25rem;
                padding: 0.5rem; /* 8px */
            }

            #submit-btn {
                font-size: 1rem;
                padding: 0.5rem 1rem;
                margin: 0.25rem auto; /* Center the button */
                max-width: 150px; /* Adjust max-width for smaller screens */
            }

            #difficulty-description {
                font-size: 0.9rem;
            }

            .mode-button {
                font-size: 1rem;
                padding: 0.5rem 1rem; /* 8px 16px */
                margin: 0.25rem; /* 4px */
            }

            #start-btn {
                font-size: 1rem;
                padding: 0.5rem 1rem; /* 8px 16px */
                margin: 0.25rem; /* 4px */
            }

            #setup label, #setup input {
                font-size: 0.9rem;
            }

            #stats {
                font-size: 1rem;
            }

            #results {
                font-size: 1.125rem; /* 18px */
            }

            #player-answer, #correct-answer {
                margin: 0.5rem 0; /* 8px 0 */
            }

            /* Tracker Responsive Styles */
            .tracker-container {
                max-width: 250px;
                padding: 15px;
            }

            .calendar-day {
                font-size: 0.7rem;
            }
        }

        @media (max-width: 480px) {
            .game-container {
                padding: 20px;
            }

            #game-area {
                width: 95%;
                padding: 15px;
            }

            #main-title {
                font-size: 1.5rem;
            }

            #message {
                font-size: 1.1rem;
            }

            #timer-display {
                font-size: 1rem;
            }

            #numbers {
                font-size: 1.5rem;
            }

            #player-input {
                font-size: 1rem;
                padding: 0.4rem; /* 6.4px */
            }

            #submit-btn {
                font-size: 0.875rem;
                padding: 0.4rem 0.8rem;
                margin: 0.2rem auto; /* Center the button */
                max-width: 120px; /* Adjust max-width for very small screens */
            }

            #difficulty-description {
                font-size: 0.8rem;
            }

            .mode-button {
                font-size: 0.875rem; /* 14px */
                padding: 0.4rem 0.8rem; /* 6.4px 12.8px */
                margin: 0.2rem; /* 3.2px */
            }

            #start-btn {
                font-size: 0.875rem; /* 14px */
                padding: 0.4rem 0.8rem; /* 6.4px 12.8px */
                margin: 0.2rem; /* 3.2px */
            }

            #setup label, #setup input {
                font-size: 0.8rem;
            }

            #stats {
                font-size: 0.875rem;
            }

            #results {
                font-size: 1rem;
            }

            #player-answer, #correct-answer {
                margin: 0.4rem 0; /* 6.4px 0 */
            }

            /* Tracker Responsive Styles */
            .tracker-container {
                max-width: 200px;
                padding: 10px;
            }

            .calendar-day {
                font-size: 0.6rem;
            }
        }

        /* New styles for the tracker */
        .tracker-container {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px auto;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            max-width: 300px;
            display: block; /* Ensure it's visible initially */
        }

        .tracker-header {
            display: flex;
            justify-content: center; /* Center the title horizontally */
            align-items: center;
            margin-bottom: 10px;
        }

        .tracker-title {
            font-size: 1.5rem;
            color: #333;
            margin: 0;
            text-align: center;
        }

        .streak-counter {
            text-align: center;
            margin: 10px 0;
            font-size: 1.2rem;
            color: #333;
        }

        .month-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .month-navigation button {
            background-color: #1e90ff;
            border: none;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .month-navigation button:hover {
            background-color: #00bfff;
        }

        .current-month-year {
            font-size: 1rem;
            color: #333;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            margin-top: 10px;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f0f0f0;
            border-radius: 5px;
            font-size: 0.8rem;
        }

        .calendar-day.active {
            background-color: #90EE90;
            color: white;
        }

        /* Hidden Class */
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1 id="main-title">Memorization Game</h1>
        <div id="game-area">
            <!-- Game messages -->
            <p id="message">Select a mode and start the game!</p>
            <!-- Timer Display -->
            <p id="timer-display"></p>
            <!-- Numbers or Characters to memorize -->
            <p id="numbers"></p>
            <!-- Input field for player guesses -->
            <input type="text" id="player-input" placeholder="Enter numbers here" maxlength="1000">
            <!-- Submit Button -->
            <button id="submit-btn">Submit</button>
            <!-- Buttons -->
            <div id="buttons">
                <!-- Mode Selection Buttons -->
                <div id="mode-selection">
                    <button class="mode-button" id="mode-number">Numbers Only</button>
                    <button class="mode-button" id="mode-mother">Mother Mode</button>
                    <button class="mode-button" id="mode-words">Words Mode</button>
                </div>
                <button id="start-btn">Start Game</button>
            </div>
            <!-- Setup Section: Number Count and Memorization Time -->
            <div id="setup">
                <div id="setup-inputs">
                    <div class="input-group">
                        <label for="number-count-input">How many characters do you want to memorize?</label>
                        <input type="number" id="number-count-input" min="1" placeholder="e.g., 10">
                    </div>
                    <div class="input-group">
                        <label for="timer-input">Memorization Time (seconds):</label>
                        <input type="number" id="timer-input" min="5" max="50" value="10" placeholder="e.g., 10">
                    </div>
                </div>
                <!-- Difficulty Description -->
                <p id="difficulty-description">
                    <strong>Difficulty Levels:</strong><br>
                    8 or below: It's okay to be weak<br>
                    9 - 15: Good stuff<br>
                    16 or above: Wanna be god?
                </p>
                <button id="confirm-setup-btn">Confirm</button>
            </div>
            <!-- Player's input and correct answer -->
            <div id="results">
                <p id="player-answer"></p>
                <p id="correct-answer"></p>
            </div>
            <!-- Score and Lives -->
            <div id="stats">
                <p id="score">Score: 0</p>
                <p id="lives">Lives: ♥♥♥</p>
            </div>
        </div>

        <!-- Tracker Section: Daily Progress -->
        <div class="tracker-container">
            <div class="tracker-header">
                <h2 class="tracker-title">Daily Progress</h2>
            </div>
            <div class="streak-counter">Current Streak: <span id="streak-count">0</span> days</div>
            <div class="month-navigation">
                <button id="prev-month">←</button>
                <span class="current-month-year" id="current-month-year"></span>
                <button id="next-month">→</button>
            </div>
            <div class="calendar-grid" id="calendar-grid">
                <!-- Calendar days will be generated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- JavaScript code -->
    <script>
        // Initialize variables
        let score = 0;
        let lives = 3;
        let numberCount = null; // Number of digits/characters to memorize
        let originalNumberCount = null; // To store original numberCount
        let numbers = [];
        let roundsUntilSurprise = randomInt(2, 5);
        let isSurpriseRound = false;
        let gameMode = null; // No mode selected initially
        let memorizeTime = 10; // Default memorization time in seconds

        // HTML Elements
        const messageEl = document.getElementById('message');
        const numbersEl = document.getElementById('numbers');
        const playerInputEl = document.getElementById('player-input');
        const submitBtn = document.getElementById('submit-btn'); // Added Submit Button
        const startBtn = document.getElementById('start-btn');
        const scoreEl = document.getElementById('score');
        const livesEl = document.getElementById('lives');
        const timerDisplayEl = document.getElementById('timer-display');
        const playerAnswerEl = document.getElementById('player-answer');
        const correctAnswerEl = document.getElementById('correct-answer');
        const modeNumberBtn = document.getElementById('mode-number');
        const modeMotherBtn = document.getElementById('mode-mother');
        const modeWordsBtn = document.getElementById('mode-words');
        const modeButtons = document.querySelectorAll('.mode-button');
        const difficultyDescriptionEl = document.getElementById('difficulty-description'); // Difficulty Description
        const setupDiv = document.getElementById('setup');
        const numberCountInputEl = document.getElementById('number-count-input');
        const timerInputEl = document.getElementById('timer-input');
        const confirmSetupBtn = document.getElementById('confirm-setup-btn');

        // Event Listeners
        modeNumberBtn.addEventListener('click', () => selectMode('number', modeNumberBtn));
        modeMotherBtn.addEventListener('click', () => selectMode('mother', modeMotherBtn));
        modeWordsBtn.addEventListener('click', () => selectMode('words', modeWordsBtn));
        startBtn.addEventListener('click', showSetup);
        confirmSetupBtn.addEventListener('click', confirmSetup);
        playerInputEl.addEventListener('keyup', function(event) {
            if (event.key === 'Enter') {
                submitInput();
            }
        });
        submitBtn.addEventListener('click', submitInput); // Added Submit Button Event Listener

        // Functions
        function selectMode(mode, button) {
            gameMode = mode;
            // Remove 'selected' class from all mode buttons
            modeButtons.forEach(btn => btn.classList.remove('selected'));
            // Add 'selected' class to the clicked button
            button.classList.add('selected');
            // Enable the Start button if mode is selected
            enableStartButton();
        }

        function enableStartButton() {
            if (gameMode) {
                startBtn.classList.add('enabled');
                startBtn.style.cursor = 'pointer';
                startBtn.style.backgroundColor = '#1e90ff';
            } else {
                startBtn.classList.remove('enabled');
                startBtn.style.backgroundColor = '#a9a9a9';
                startBtn.style.cursor = 'not-allowed';
            }
        }


        function showSetup() {
            if (!gameMode) return; // Do nothing if no mode is selected
                // Hide Mode Selection Buttons and Start Button
            document.getElementById('mode-selection').style.display = 'none';
            startBtn.style.display = 'none';
            // Show Setup Section
            setupDiv.style.display = 'block';
            messageEl.textContent = 'Set Up Your Game';
            numberCountInputEl.focus();

            // Update the label text based on the selected game mode
            const numberCountLabel = document.querySelector('label[for="number-count-input"]');
            if (gameMode === 'words') {
                numberCountLabel.textContent = 'How many words do you want to memorize?';
            } else if (gameMode === 'number') {
                numberCountLabel.textContent = 'How many numbers do you want to memorize?';
            } else if (gameMode === 'mother') {
                numberCountLabel.textContent = 'How many characters do you want to memorize?';
            }
        }


        function confirmSetup() {
            // Read and validate number count
            const count = parseInt(numberCountInputEl.value);
            if (!Number.isInteger(count) || count < 1) {
                alert('Please enter a valid number of characters greater than 0.');
                numberCountInputEl.focus();
                return;
            }

            // Read and validate memorization time
            const time = parseInt(timerInputEl.value);
            if (!Number.isInteger(time) || time < 5 || time > 50) {
                alert('Please enter a valid memorization time between 5 and 50 seconds.');
                timerInputEl.focus();
                return;
            }

            numberCount = count;
            memorizeTime = time;
            setupDiv.style.display = 'none';
            startGame();
        }

        function startGame() {
            // Do NOT reset streak or activeDays here
            // Instead, simply reset game stats and UI
            resetGameStats();
            updateStats();
            resetDisplay();
            startRound();
        }

        function resetGameStats() {
            score = 0;
            lives = 3;
            roundsUntilSurprise = randomInt(2, 5);
            isSurpriseRound = false;
            updateStats();
        }

        function resetDisplay() {
            messageEl.textContent = '';
            numbersEl.textContent = '';
            timerDisplayEl.textContent = '';
            playerAnswerEl.textContent = '';
            correctAnswerEl.textContent = '';
        }

        function startRound() {
            if (lives <= 0) {
                gameOver();
                return;
            }

            resetDisplay();
            if (roundsUntilSurprise === 0) {
                isSurpriseRound = true;
                roundsUntilSurprise = randomInt(2, 5);
                originalNumberCount = numberCount; // Save the original number count
                numberCount = getRandomOddNumber(1, 13); // Random odd number between 1 and 13
            } else {
                isSurpriseRound = false;
                roundsUntilSurprise--;
            }

            numbers = generateNumbers(numberCount);
            displayNumbers();
        }

        function displayNumbers() {
            let timeLeft = memorizeTime;
            messageEl.textContent = isSurpriseRound ? getDynamicMessage('surpriseRound') : getDynamicMessage('memorize');
            numbersEl.textContent = numbers.join(' ');
            playerInputEl.style.display = 'none';
            submitBtn.style.display = 'none'; // Ensure submit button is hidden
            timerDisplayEl.textContent = `Time Remaining: ${timeLeft} seconds`;

            const timer = setInterval(() => {
                timeLeft--;
                timerDisplayEl.textContent = `Time Remaining: ${timeLeft} seconds`;
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    hideNumbers();
                }
            }, 1000);
        }

        function hideNumbers() {
            messageEl.textContent = getDynamicMessage('enterCharacters');
            numbersEl.textContent = '';
            timerDisplayEl.textContent = '';
            playerInputEl.style.display = 'block';
            submitBtn.style.display = 'block'; // Show submit button
            playerInputEl.value = '';
            playerInputEl.placeholder = getDynamicPlaceholder('input');
            playerInputEl.focus();
        }


        function submitInput() {
            if (numberCount === null) {
                // Not used in current setup
                return;
            } else if (numbers.length > 0) {
                // Player is submitting their guess
                const inputStr = playerInputEl.value.trim();

                if (gameMode === 'number') {
                    // Code for 'number' mode
                    if (/^[\d\s]+$/.test(inputStr)) {
                        const inputDigits = inputStr.split(/\s+/).filter(s => s !== '');
                        let playerGuess = [];

                        if (inputDigits.length === numberCount) {
                            playerGuess = inputDigits.map(Number);
                        } else if (inputDigits.length === 1 && inputDigits[0].length === numberCount) {
                            // User entered all digits together without spaces
                            playerGuess = inputDigits[0].split('').map(Number);
                        }

                        if (playerGuess.length === numberCount && playerGuess.every(num => !isNaN(num))) {
                            playerInputEl.value = ''; // Reset input field after each round
                            checkGuess(playerGuess);
                        } else {
                            messageEl.textContent = `Please enter exactly ${numberCount} digits.`;
                            playerInputEl.value = '';
                        }
                    } else {
                        messageEl.textContent = 'Please enter only numbers and spaces.';
                        playerInputEl.value = '';
                    }
                } else if (gameMode === 'mother') {
                    // Code for 'mother' mode
                    if (/^[A-Za-z0-9\s]+$/.test(inputStr)) {
                        const inputChars = inputStr.split(/\s+/).filter(s => s !== '');
                        let playerGuess = [];

                        if (inputChars.length === numberCount) {
                            playerGuess = inputChars;
                        } else if (inputChars.length === 1 && inputChars[0].length === numberCount) {
                            // User entered all characters together without spaces
                            playerGuess = inputChars[0].split('');
                        }

                        if (playerGuess.length === numberCount && playerGuess.every(char => /^[A-Za-z0-9]$/.test(char))) {
                            playerInputEl.value = ''; // Reset input field after each round
                            checkGuess(playerGuess);
                        } else {
                            messageEl.textContent = `Please enter exactly ${numberCount} characters (letters or numbers).`;
                            playerInputEl.value = '';
                        }
                    } else {
                        messageEl.textContent = 'Please enter only letters, numbers, and spaces.';
                        playerInputEl.value = '';
                    }
                } else if (gameMode === 'words') {
                    // Code for 'words' mode
                    if (/^[A-Za-z\s]+$/.test(inputStr)) {
                        const inputWords = inputStr.split(/\s+/).filter(s => s !== '');
                        let playerGuess = [];

                        if (inputWords.length === numberCount) {
                            playerGuess = inputWords.map(word => word.toLowerCase());
                            playerInputEl.value = ''; // Reset input field after each round
                            checkGuess(playerGuess);
                        } else {
                            messageEl.textContent = `Please enter exactly ${numberCount} words.`;
                            playerInputEl.value = '';
                        }
                    } else {
                        messageEl.textContent = 'Please enter only letters and spaces.';
                        playerInputEl.value = '';
                    }
                }
            }
        }



        function checkGuess(playerGuess) {
            const correctCount = numbers.reduce((count, item, index) => {
                if (gameMode === 'number' || gameMode === 'mother') {
                    return item === playerGuess[index] ? count + 1 : count;
                } else if (gameMode === 'words') {
                    const processedItem = item.replace(/-/g, ' ').toLowerCase();
                    const processedGuess = playerGuess[index].replace(/-/g, ' ').toLowerCase();
                    return processedItem === processedGuess ? count + 1 : count;
                }
                return count;
            }, 0);

            playerInputEl.style.display = 'none';
            submitBtn.style.display = 'none'; // Hide submit button

            // Display player's input and correct answer
            playerAnswerEl.textContent = `Your Input: ${formatGuess(playerGuess)}`;
            correctAnswerEl.textContent = `Correct Sequence: ${formatGuess(numbers)}`;

            if (isSurpriseRound) {
                handleSurpriseRound(correctCount);
            } else {
                if (arraysEqual(playerGuess, numbers)) {
                    score++;
                    messageEl.textContent = getDynamicMessage('correct');
                    updateStats();
                    nextRound();
                } else {
                    lives--;
                    messageEl.textContent = lives > 0 ? getDynamicMessage('wrong', lives) : getDynamicMessage('wrongNoLives');
                    updateStats();
                    if (lives <= 0) {
                        gameOver();
                    } else {
                        nextRound();
                    }
                }
            }
        }


        function handleSurpriseRound(correctCount) {
            const probability = correctCount === 0 ? 0 : Math.pow(correctCount / numberCount, 2);
            const chance = Math.random();
            const savedLife = chance <= probability;

            let emotionMessage = '';
            if (correctCount === numberCount && savedLife) {
                emotionMessage = 'Amazing! You got a perfect score!';
            } else if (correctCount > numberCount * 0.7 && !savedLife) {
                emotionMessage = 'So close! Unlucky this time.';
            } else if (correctCount < numberCount * 0.3 && savedLife) {
                emotionMessage = 'Wow! You got lucky!';
            } else if (correctCount === 0) {
                emotionMessage = "Don't worry, keep trying!";
            } else {
                emotionMessage = savedLife ? 'Good job! You saved a life!' : 'Better luck next time!';
            }

            if (savedLife) {
                score++;
            } else {
                lives--;
            }

            messageEl.textContent = emotionMessage;
            updateStats();

            // Restore original numberCount after surprise round
            numberCount = originalNumberCount;

            if (lives <= 0) {
                gameOver();
            } else {
                nextRound();
            }
        }

        function nextRound() {
            setTimeout(() => {
                playerAnswerEl.textContent = '';
                correctAnswerEl.textContent = '';
                startRound();
            }, 3000);
        }

        function gameOver() {
            messageEl.textContent = `Game Over! Your final score: ${score}`;
            numbersEl.textContent = '';
            timerDisplayEl.textContent = '';
            playerAnswerEl.textContent = '';
            correctAnswerEl.textContent = '';
            playerInputEl.style.display = 'none';
            submitBtn.style.display = 'none'; // Hide submit button
            startBtn.textContent = 'Play Again';
            startBtn.classList.remove('enabled');
            startBtn.style.backgroundColor = '#1e90ff';
            startBtn.style.cursor = 'pointer';
            startBtn.style.display = 'inline-block';
            setupDiv.style.display = 'none'; // Hide Setup Section
            document.getElementById('mode-selection').style.display = 'block'; // Show Mode Selection
            modeButtons.forEach(btn => btn.classList.remove('selected')); // Deselect mode buttons
            gameMode = null; // Reset gameMode
            numberCount = null; // Reset numberCount for new game
            // Reset timer input to default value
            timerInputEl.value = '10';
            memorizeTime = 10;

            // Mark today as played
            markTodayAsPlayed();

            // Show the tracker container again
            document.querySelector('.tracker-container').style.display = 'block';
        }

        function updateStats() {
            scoreEl.textContent = 'Score: ' + score;
            livesEl.textContent = 'Lives: ' + '♥'.repeat(lives);
        }

        function generateNumbers(count) {
            const chars = [];
            if (gameMode === 'words') {
                // Add your own words generation logic here
                const wordsList = [ 
                    // **Animals**
                    // *Mammals*
                    'lion', 'tiger', 'elephant', 'giraffe', 'kangaroo', 'zebra', 'monkey',
                    'bear', 'wolf', 'fox', 'deer', 'panda', 'koala', 'squirrel', 'bat',
                    
                    // *Birds*
                    'eagle', 'parrot', 'penguin', 'sparrow', 'owl', 'falcon', 'hawk',
                    'pigeon', 'crow', 'seagull',
                    
                    // **Fruits**
                    'apple', 'banana', 'cherry', 'mango', 'pineapple', 'orange',
                    'strawberry', 'blueberry', 'raspberry', 'grapes', 'watermelon',
                    'lemon', 'lime', 'peach', 'pear', 'plum',
                    
                    // **Vegetables**
                    'carrot', 'broccoli', 'spinach', 'potato', 'tomato', 'lettuce',
                    'cucumber', 'bellpepper', 'onion', 'garlic', 'zucchini', 'eggplant',
                    'cauliflower', 'kale', 'cabbage', 'peas', 'greenbeans', 'asparagus',
                    
                    // **Household Items**
                    // *Kitchen Items*
                    'refrigerator', 'stove', 'microwave', 'toaster', 'blender',
                    'dishwasher', 'coffeemaker', 'kettle', 'oven', 'freezer',
                    'toasteroven', 'ricecooker', 'slowcooker', 'airfryer',
                    'electricgrill', 'foodprocessor', 'juicer', 'mixer',
                    'cuttingboard', 'knifeset', 'measuringcups', 'measuringspoons',
                    'mixingbowls', 'strainer', 'grater', 'peeler', 'spatula',
                    'whisk',
                    
                    // *Living Room Items*
                    'sofa', 'coffeetable', 'television', 'lamp', 'bookshelf',
                    'armchair', 'recliner', 'ottoman', 'rug', 'curtains',
                    'blinds', 'artwork', 'pictureframe', 'mirror', 'candle',
                    'vase', 'plant', 'remotecontrol', 'speaker', 'fan',
                    
                    // **Technology**
                    // *Computers and Accessories*
                    'laptop', 'desktop', 'mouse', 'keyboard', 'monitor',
                    'printer', 'scanner', 'externalharddrive', 'usbflashdrive',
                    'webcam', 'microphone', 'headset', 'speakers', 'router',
                    'modem', 'graphicscard', 'motherboard', 'powersupply',
                    'computercase', 'SSD', 'HDD', 'RAM', 'graphicstablet',
                    
                    // *Mobile Devices*
                    'smartphone', 'tablet', 'smartwatch', 'ereader',
                    'portablecharger', 'powerbank', 'smartphonecase',
                    'screenprotector', 'tabletstand', 'stylus', 'wirelessearbuds',
                    'bluetoothheadphones', 'portablespeaker', 'fitnesstracker',
                    'VRheadset', 'actioncamera', 'dronecontroller',
                    'mobilerouter', 'SIMcard', 'microSDcard', 'phonemount',
                    'carcharger', 'wirelesscharger', 'chargingcable',
                    
                    // **Gadgets**
                    'drone', 'VRheadset', 'fitnesstracker', 'bluetoothspeaker',
                    'digitalcamera', 'smartlightbulb', 'smartplug',
                    'smartthermostat', 'smartlock', 'smartdoorbell',
                    'smartsecuritycamera', 'smartdisplay', 'smartremote',
                    'smartglasses', 'smartspeaker', 'smartvacuum',
                    'smartairpurifier', 'smartcoffeemaker', 'smartkettle',
                    
                    // **Clothing and Accessories**
                    // *Clothing Items*
                    'tshirt', 'jeans', 'jacket', 'dress', 'shorts', 'skirt',
                    'sweater', 'coat', 'blouse', 'shirt', 'tanktop', 'sweatshirt',
                    'hoodie', 'vest', 'blazer', 'leggings', 'sneakers',
                    'boots', 'sandals', 'heels', 'flats',
                    
                    // *Accessories*
                    'hat', 'scarf', 'belt', 'sunglasses', 'watch', 'bracelet',
                    'necklace', 'earrings', 'rings', 'handbag', 'backpack',
                    'wallet', 'purse', 'gloves', 'mittens', 'hairband',
                    'headband', 'tie', 'bowtie',
                    
                    // **Office Supplies**
                    'notebook', 'pen', 'stapler', 'printer', 'paperclips',
                    'pencil', 'eraser', 'marker', 'highlighter', 'binder',
                    'folder', 'stickynotes', 'scissors', 'tape', 'ruler',
                    'calculator', 'pushpins', 'filecabinet', 'envelope',
                    'letteropener', 'whiteboard', 'dryerasemarkers',
                    'deskorganizer', 'filefolders', 'desklamp', 'officechair',
                    'desk', 'computerdesk', 'shredder', 'trashcan',
                    
                    // **Food & Beverages**
                    'pizza', 'hamburger', 'sushi', 'pasta', 'salad', 'steak',
                    'taco', 'sandwich', 'soup', 'icecream', 'cake',
                    'brownie', 'donut', 'pancake', 'waffle', 'bagel',
                    'croissant', 'cheese', 'bread', 'butter', 'jam',
                    'honey', 'cereal', 'oatmeal', 'yogurt', 'milkshake',
                    'coffee', 'tea', 'juice', 'soda', 'water', 'wine',
                    'beer',
                    
                    // **Music**
                    'guitar', 'piano', 'violin', 'drums', 'flute', 'saxophone',
                    'trumpet', 'cello', 'clarinet', 'banjo', 'trombone', 'ukulele',
                ];

                const selectedWords = [];
                while (selectedWords.length < count) {
                    const randomWord = wordsList[Math.floor(Math.random() * wordsList.length)];
                    if (selectedWords.length === 0 || !areRelated(selectedWords[selectedWords.length - 1], randomWord)) {
                        selectedWords.push(randomWord);
                    }
                }
                chars.push(...selectedWords);
            } else {
                for (let i = 0; i < count; i++) {
                    if (gameMode === 'number') {
                        chars.push(randomInt(0, 9));
                    } else if (gameMode === 'mother') {
                        chars.push(randomAlphaNumeric());
                    }
                }
            }
            return chars;
        }

        function areRelated(word1, word2) {
            // Define your logic to determine if two words are related
            // For example, you can consider words related if they start with the same letter
            return word1.charAt(0).toLowerCase() === word2.charAt(0).toLowerCase();
        }


        function randomAlphaNumeric() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            return chars.charAt(Math.floor(Math.random() * chars.length));
        }

        function randomInt(min, max, step = 1) {
            const range = Math.floor((max - min + step) / step);
            return min + step * Math.floor(Math.random() * range);
        }

        function getRandomOddNumber(min, max) {
            let num;
            do {
                num = randomInt(min, max);
            } while (num % 2 === 0);
            return num;
        }

        function arraysEqual(a1, a2) {
            if (a1.length !== a2.length) return false;
            for (let i = 0; i < a1.length; i++) {
                if (gameMode === 'number' || gameMode === 'mother') {
                    if (a1[i] !== a2[i]) return false;
                } else if (gameMode === 'words') {
                    // Remove hyphens and convert to lowercase for accurate comparison
                    const processedA1 = a1[i].replace(/-/g, ' ').toLowerCase();
                    const processedA2 = a2[i].replace(/-/g, ' ').toLowerCase();
                    if (processedA1 !== processedA2) return false;
                }
            }
            return true;
        }


        function formatGuess(guessArray) {
            return guessArray.join(' ');
        }

        function getDynamicMessage(type, livesLeft) {
            const messages = {
                promptCount: 
                    gameMode === 'number' ? 'How many numbers do you want to memorize?' :
                    gameMode === 'mother' ? 'How many characters do you want to memorize?' :
                    'How many words do you want to memorize?',
                memorize: 
                    gameMode === 'number' ? 'Memorize these numbers:' :
                    gameMode === 'mother' ? 'Memorize these characters:' :
                    'Memorize these words:',
                surpriseRound: 
                    gameMode === 'number' ? 'Surprise Round! Memorize these numbers:' :
                    gameMode === 'mother' ? 'Surprise Round! Memorize these characters:' :
                    'Surprise Round! Memorize these words:',
                enterCharacters: 
                    gameMode === 'number' ? 'Enter the numbers:' :
                    gameMode === 'mother' ? 'Enter the characters:' :
                    'Enter the words:',
                correct: 'Correct! You win this round!',
                wrong: (livesLeft) => `Wrong! ${livesLeft} ${livesLeft === 1 ? 'life' : 'lives'} left.`,
                wrongNoLives: 'Wrong! No lives left.',
                selectMode: 'Select a mode and start the game!'
            };

            if (typeof messages[type] === 'function') {
                return messages[type](livesLeft);
            }

            return messages[type] || '';
        }

        function getDynamicPlaceholder(type) {
            const placeholders = {
                input: 
                    gameMode === 'number' ? 'Enter numbers here' :
                    gameMode === 'mother' ? 'Enter characters here' :
                    'Enter words here (separate with spaces)'
            };
            return placeholders[type] || 'Enter input here';
        }

        // ----------------------------
        // Tracker Functionality Starts
        // ----------------------------

        let streakCount = 0;
        let trackerData = {
            activeDays: [],
            lastPlayed: null,
            streakCount: 0
        };
        let currentMonth = new Date().getMonth();
        let currentYear = new Date().getFullYear();

        // Load tracker data from localStorage
        function loadTrackerData() {
            const savedData = localStorage.getItem('memoryGameTracker');
            if (savedData) {
                trackerData = JSON.parse(savedData);
                updateStreakCount();
                renderCalendar(currentMonth, currentYear);
            } else {
                renderCalendar(currentMonth, currentYear);
            }
        }

        // Save tracker data to localStorage
        function saveTrackerData() {
            localStorage.setItem('memoryGameTracker', JSON.stringify(trackerData));
        }

        // Update streak count
        function updateStreakCount() {
            document.getElementById('streak-count').textContent = trackerData.streakCount;
        }

        // Render calendar
        function renderCalendar(month, year) {
            const calendarGrid = document.getElementById('calendar-grid');
            const currentMonthYearEl = document.getElementById('current-month-year');
            calendarGrid.innerHTML = '';

            const firstDay = (new Date(year, month)).getDay();
            const daysInMonth = 32 - new Date(year, month, 32).getDate();

            currentMonthYearEl.textContent = `${getMonthName(month)} ${year}`;

            // Create empty cells for days before the first day of the month
            for (let i = 0; i < firstDay; i++) {
                const emptyCell = document.createElement('div');
                calendarGrid.appendChild(emptyCell);
            }

            for (let i = 1; i <= daysInMonth; i++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                dayElement.textContent = i;

                const date = new Date(year, month, i);
                const dateStr = date.toLocaleDateString();

                if (trackerData.activeDays.includes(dateStr)) {
                    dayElement.classList.add('active');
                }

                calendarGrid.appendChild(dayElement);
            }
        }

        function getMonthName(monthIndex) {
            const monthNames = [
                'January', 'February', 'March', 'April', 'May', 'June',
                'July', 'August', 'September', 'October', 'November', 'December'
            ];
            return monthNames[monthIndex];
        }

        // Function to mark today as played and update the streak
        function markTodayAsPlayed() {
            const today = new Date();
            const todayStr = today.toLocaleDateString();

            // Check if today is already marked
            if (!trackerData.activeDays.includes(todayStr)) {
                trackerData.activeDays.push(todayStr);

                // Calculate streak
                if (trackerData.lastPlayed) {
                    const lastPlayedDate = new Date(trackerData.lastPlayed);
                    const yesterday = new Date();
                    yesterday.setDate(yesterday.getDate() - 1);

                    // Check if lastPlayed was yesterday
                    if (lastPlayedDate.toDateString() === yesterday.toDateString()) {
                        streakCount = (trackerData.streakCount || 0) + 1;
                    } else if (lastPlayedDate.toDateString() === today.toDateString()) {
                        // Already played today, no change
                        streakCount = trackerData.streakCount;
                    } else {
                        // Streak broken
                        streakCount = 1;
                    }
                } else {
                    // First time playing
                    streakCount = 1;
                }

                // Update tracker data
                trackerData.lastPlayed = todayStr;
                trackerData.streakCount = streakCount;

                // Save and update UI
                saveTrackerData();
                updateStreakCount();
                renderCalendar(currentMonth, currentYear);
            }
        }

        // Add toggle functionality for the tracker button
        // Removed the button as per user request

        // Add month navigation functionality
        document.getElementById('prev-month').addEventListener('click', function() {
            currentMonth--;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            renderCalendar(currentMonth, currentYear);
        });

        document.getElementById('next-month').addEventListener('click', function() {
            currentMonth++;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            renderCalendar(currentMonth, currentYear);
        });

        // Initialize tracker
        loadTrackerData();

        // Track game start
        function trackGameStart() {
            // Hide the tracker container when the game starts
            document.querySelector('.tracker-container').style.display = 'none';
        }

        // Track game end and update the tracker
        function trackGameEnd() {
            // Show the tracker container when the game ends
            document.querySelector('.tracker-container').style.display = 'block';
            // Mark today as played
            markTodayAsPlayed();
        }

        // Modify gameOver() to track game end
        const originalGameOver = gameOver;
        gameOver = function() {
            originalGameOver(); // Call the original gameOver logic
            trackGameEnd(); // Update the tracker after game over
        };

        // Modify startRound() to track game start
        const originalStartRound = startRound;
        startRound = function() {
            trackGameStart(); // Hide the tracker when the game starts
            originalStartRound(); // Call the original startRound logic
        };

        // ----------------------------
        // Tracker Functionality Ends
        // ----------------------------
    </script>
</body>
</html>
